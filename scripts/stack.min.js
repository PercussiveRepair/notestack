(function(b,l){var a=b.jQuery||b.Cowboy||(b.Cowboy={}),c;a.throttle=c=function(c,b,g,h){function o(){function a(){r=+new Date;g.apply(t,u)}function o(){n=l}var t=this,s=+new Date-r,u=arguments;h&&!n&&a();n&&clearTimeout(n);h===l&&s>c?a():b!==!0&&(n=setTimeout(h?o:a,h===l?c-s:c))}var n,r=0;typeof b!=="boolean"&&(h=g,g=b,b=l);if(a.guid)o.guid=g.guid=g.guid||a.guid++;return o};a.debounce=function(a,b,g){return g===l?c(a,b,!1):c(a,g,b!==!1)}})(this);
jQuery.fn.sortElements=function(){var b=[].sort;return function(l,a){var a=a||function(){return this},c=this.map(function(){var c=a.call(this),b=c.parentNode,g=b.insertBefore(document.createTextNode(""),c.nextSibling);return function(){if(b===this)throw Error("You can't sort elements if any one is a descendant of another.");b.insertBefore(this,g);b.removeChild(g)}});return b.call(this,l).each(function(f){c[f].call(a.call(this))})}}();
(function(b){b.fn.tabby=function(l){var a=b.extend({},b.fn.tabby.defaults,l),c=b.fn.tabby.pressed;return this.each(function(){$this=b(this);var f=b.meta?b.extend({},a,$this.data()):a;$this.bind("keydown",function(a){var g=b.fn.tabby.catch_kc(a);if(16==g)c.shft=!0;if(17==g)c.ctrl=!0,setTimeout("$.fn.tabby.pressed.ctrl = false;",1E3);if(18==g)c.alt=!0,setTimeout("$.fn.tabby.pressed.alt = false;",1E3);if(9==g&&!c.ctrl&&!c.alt){c.last=g;setTimeout("$.fn.tabby.pressed.last = null;",0);var a=b(a.target).get(0),
h=c.shft,g=a.scrollTop;if(a.setSelectionRange){var o=a.selectionStart,n=a.selectionEnd;if(o==n)if(h)if("\t"==a.value.substring(o-f.tabString.length,o))a.value=a.value.substring(0,o-f.tabString.length)+a.value.substring(o),a.focus(),a.setSelectionRange(o-f.tabString.length,o-f.tabString.length);else{if("\t"==a.value.substring(o,o+f.tabString.length))a.value=a.value.substring(0,o)+a.value.substring(o+f.tabString.length),a.focus(),a.setSelectionRange(o,o)}else a.value=a.value.substring(0,o)+f.tabString+
a.value.substring(o),a.focus(),a.setSelectionRange(o+f.tabString.length,o+f.tabString.length);else{var l=a.value.split("\n"),p=[],q=0,t=0,s;for(s in l)t=q+l[s].length,p.push({start:q,end:t,selected:q<=o&&t>o||t>=n&&q<n||q>o&&t<n}),q=t+1;l=0;for(s in p)if(p[s].selected)if(q=p[s].start+l,h&&f.tabString==a.value.substring(q,q+f.tabString.length))a.value=a.value.substring(0,q)+a.value.substring(q+f.tabString.length),l-=f.tabString.length;else if(!h)a.value=a.value.substring(0,q)+f.tabString+a.value.substring(q),
l+=f.tabString.length;a.focus();a.setSelectionRange(o+(l>0?f.tabString.length:l<0?-f.tabString.length:0),n+l)}}else if(document.selection&&(s=document.selection.createRange(),a==s.parentElement()))if(""==s.text){if(h){h=s.getBookmark();s.moveStart("character",-f.tabString.length);if(f.tabString==s.text)s.text="";else if(s.moveToBookmark(h),s.moveEnd("character",f.tabString.length),f.tabString==s.text)s.text="";s.collapse(!0)}else s.text=f.tabString,s.collapse(!1);s.select()}else{n=s.text;o=n.length;
p=n.split("\r\n");n=document.body.createTextRange();n.moveToElementText(a);n.setEndPoint("EndToStart",s);q=n.text;l=q.split("\r\n");q=q.length;t=document.body.createTextRange();t.moveToElementText(a);t.setEndPoint("StartToEnd",s);var t=t.text,u=document.body.createTextRange();u.moveToElementText(a);u.setEndPoint("StartToEnd",n);var w=u.text,u=b(a).html();b("#r3").text(q+" + "+o+" + "+t.length+" = "+u.length);q+w.length<u.length?(l.push(""),q+=2,h&&f.tabString==p[0].substring(0,f.tabString.length)?
p[0]=p[0].substring(f.tabString.length):h||(p[0]=f.tabString+p[0])):h&&f.tabString==l[l.length-1].substring(0,f.tabString.length)?l[l.length-1]=l[l.length-1].substring(f.tabString.length):h||(l[l.length-1]=f.tabString+l[l.length-1]);for(w=1;w<p.length;w++)h&&f.tabString==p[w].substring(0,f.tabString.length)?p[w]=p[w].substring(f.tabString.length):h||(p[w]=f.tabString+p[w]);1==l.length&&0==q&&(h&&f.tabString==p[0].substring(0,f.tabString.length)?p[0]=p[0].substring(f.tabString.length):h||(p[0]=f.tabString+
p[0]));q+o+t.length<u.length&&p.push("");n.text=l.join("\r\n");s.text=p.join("\r\n");h=document.body.createTextRange();h.moveToElementText(a);0<q?h.setEndPoint("StartToEnd",n):h.setEndPoint("StartToStart",n);h.setEndPoint("EndToEnd",s);h.select()}a.scrollTop=g;return!1}}).bind("keyup",function(a){if(16==b.fn.tabby.catch_kc(a))c.shft=!1}).bind("blur",function(a){9==c.last&&b(a.target).one("focus",function(){c.last=null}).get(0).focus()})})};b.fn.tabby.catch_kc=function(b){return b.keyCode?b.keyCode:
b.charCode?b.charCode:b.which};b.fn.tabby.pressed={shft:!1,ctrl:!1,alt:!1,last:null};b.fn.tabby.defaults={tabString:String.fromCharCode(9)}})(jQuery);
(function(b){b.fn.extend({autocomplete:function(l,a){var c=typeof l=="string",a=b.extend({},b.Autocompleter.defaults,{url:c?l:null,data:c?null:l,delay:c?b.Autocompleter.defaults.delay:10,max:a&&!a.scroll?10:150},a);a.highlight=a.highlight||function(a){return a};a.formatMatch=a.formatMatch||a.formatItem;return this.each(function(){new b.Autocompleter(this,a)})},result:function(b){return this.bind("result",b)},search:function(b){return this.trigger("search",[b])},flushCache:function(){return this.trigger("flushCache")},
setOptions:function(b){return this.trigger("setOptions",[b])},unautocomplete:function(){return this.trigger("unautocomplete")}});b.Autocompleter=function(l,a){function c(){var c=v.selected();if(!c)return!1;var f=c.result;t=f;if(a.multiple){var g=m(p.val());if(g.length>1){var o=a.multipleSeparator.length,n=b(l).selection().start,r,q=0;b.each(g,function(a,c){q+=c.length;if(n<=q)return r=a,!1;q+=o});g[r]=f;f=g.join(a.multipleSeparator)}f+=a.multipleSeparator}p.val(f);h();p.trigger("result",[c.data,c.value]);
return!0}function f(c,f){if(w==r.DEL)v.hide();else{var b=p.val();if(f||b!=t)t=b,b=g(b),b.length>=a.minChars?(p.addClass(a.loadingClass),a.matchCase||(b=b.toLowerCase()),n(b,o,h)):(p.removeClass(a.loadingClass),v.hide())}}function m(c){if(!c)return[""];if(!a.multiple)return[b.trim(c)];return b.map(c.split(a.multipleSeparator),function(a){return b.trim(c).length?b.trim(a):null})}function g(c){if(!a.multiple)return c;var f=m(c);if(f.length==1)return f[0];f=b(l).selection().start;f=f==c.length?m(c):m(c.replace(c.substring(f),
""));return f[f.length-1]}function h(){v.visible();v.hide();clearTimeout(q);p.removeClass(a.loadingClass);a.mustMatch&&p.search(function(c){c||(a.multiple?(c=m(p.val()).slice(0,-1),p.val(c.join(a.multipleSeparator)+(c.length?a.multipleSeparator:""))):(p.val(""),p.trigger("result",null)))})}function o(c,f){if(f&&f.length&&u){p.removeClass(a.loadingClass);v.display(f,c);var m=f[0].value;a.autoFill&&g(p.val()).toLowerCase()==c.toLowerCase()&&w!=r.BACKSPACE&&(p.val(p.val()+m.substring(g(t).length)),b(l).selection(t.length,
t.length+m.length));v.show()}else h()}function n(c,f,m){a.matchCase||(c=c.toLowerCase());var h=s.load(c);if(h&&h.length)f(c,h);else if(typeof a.url=="string"&&a.url.length>0){var o={timestamp:+new Date};b.each(a.extraParams,function(a,c){o[a]=typeof c=="function"?c():c});b.ajax({mode:"abort",port:"autocomplete"+l.name,dataType:a.dataType,url:a.url,data:b.extend({q:g(c),limit:a.max},o),success:function(g){var m;if(!(m=a.parse&&a.parse(g))){m=[];for(var g=g.split("\n"),h=0;h<g.length;h++){var o=b.trim(g[h]);
o&&(o=o.split("|"),m[m.length]={data:o,value:o[0],result:a.formatResult&&a.formatResult(o,o[0])||o[0]})}}s.add(c,m);f(c,m)}})}else v.emptyList(),m(c)}var r={UP:38,DOWN:40,DEL:46,TAB:9,RETURN:13,ESC:27,COMMA:188,PAGEUP:33,PAGEDOWN:34,BACKSPACE:8},p=b(l).attr("autocomplete","off").addClass(a.inputClass),q,t="",s=b.Autocompleter.Cache(a),u=0,w,z={mouseDownOnSelect:!1},v=b.Autocompleter.Select(a,l,c,z),y;b.browser.opera&&b(l.form).bind("submit.autocomplete",function(){if(y)return y=!1});p.bind((b.browser.opera?
"keypress":"keydown")+".autocomplete",function(g){u=1;w=g.keyCode;switch(g.keyCode){case r.UP:g.preventDefault();v.visible()?v.prev():f(0,!0);break;case r.DOWN:g.preventDefault();v.visible()?v.next():f(0,!0);break;case r.PAGEUP:g.preventDefault();v.visible()?v.pageUp():f(0,!0);break;case r.PAGEDOWN:g.preventDefault();v.visible()?v.pageDown():f(0,!0);break;case a.multiple&&b.trim(a.multipleSeparator)==","&&r.COMMA:case r.TAB:case r.RETURN:if(c())return g.preventDefault(),y=!0,!1;break;case r.ESC:v.hide();
break;default:clearTimeout(q),q=setTimeout(f,a.delay)}}).focus(function(){u++}).blur(function(){u=0;z.mouseDownOnSelect||(clearTimeout(q),q=setTimeout(h,200))}).click(function(){u++>1&&!v.visible()&&f(0,!0)}).bind("search",function(){function a(f,b){var g;if(b&&b.length)for(var m=0;m<b.length;m++)if(b[m].result.toLowerCase()==f.toLowerCase()){g=b[m];break}typeof c=="function"?c(g):p.trigger("result",g&&[g.data,g.value])}var c=arguments.length>1?arguments[1]:null;b.each(m(p.val()),function(c,f){n(f,
a,a)})}).bind("flushCache",function(){s.flush()}).bind("setOptions",function(c,f){b.extend(a,f);"data"in f&&s.populate()}).bind("unautocomplete",function(){v.unbind();p.unbind();b(l.form).unbind(".autocomplete")})};b.Autocompleter.defaults={inputClass:"ac_input",resultsClass:"ac_results",loadingClass:"ac_loading",minChars:1,delay:400,matchCase:!1,matchSubset:!0,matchContains:!1,cacheLength:10,max:100,mustMatch:!1,extraParams:{},selectFirst:!0,formatItem:function(b){return b[0]},formatMatch:null,autoFill:!1,
width:0,multiple:!1,multipleSeparator:", ",highlight:function(b,a){return b.replace(RegExp("(?![^&;]+;)(?!<[^<>]*)("+a.replace(/([\^\$\(\)\[\]\{\}\*\.\+\?\|\\])/gi,"\\$1")+")(?![^<>]*>)(?![^&;]+;)","gi"),"<strong>$1</strong>")},scroll:!0,scrollHeight:180};b.Autocompleter.Cache=function(l){function a(a,c){l.matchCase||(a=a.toLowerCase());var f=a.indexOf(c);l.matchContains=="word"&&(f=a.toLowerCase().search("\\b"+c.toLowerCase()));if(f==-1)return!1;return f==0||l.matchContains}function c(a,c){h>l.cacheLength&&
m();g[a]||h++;g[a]=c}function f(){if(!l.data)return!1;var a={},f=0;if(!l.url)l.cacheLength=1;a[""]=[];for(var g=0,m=l.data.length;g<m;g++){var h=l.data[g],h=typeof h=="string"?[h]:h,t=l.formatMatch(h,g+1,l.data.length);if(t!==!1){var s=t.charAt(0).toLowerCase();a[s]||(a[s]=[]);h={value:t,data:h,result:l.formatResult&&l.formatResult(h)||t};a[s].push(h);f++<l.max&&a[""].push(h)}}b.each(a,function(a,f){l.cacheLength++;c(a,f)})}function m(){g={};h=0}var g={},h=0;setTimeout(f,25);return{flush:m,add:c,
populate:f,load:function(c){if(!l.cacheLength||!h)return null;if(!l.url&&l.matchContains){var f=[],m;for(m in g)if(m.length>0){var p=g[m];b.each(p,function(b,g){a(g.value,c)&&f.push(g)})}return f}else if(g[c])return g[c];else if(l.matchSubset)for(m=c.length-1;m>=l.minChars;m--)if(p=g[c.substr(0,m)])return f=[],b.each(p,function(b,g){a(g.value,c)&&(f[f.length]=g)}),f;return null}}};b.Autocompleter.Select=function(l,a,c,f){function m(){t&&(s=b("<div/>").hide().addClass(l.resultsClass).css("position",
"absolute").appendTo(document.body),u=b("<ul/>").appendTo(s).mouseover(function(a){g(a).nodeName&&g(a).nodeName.toUpperCase()=="LI"&&(r=b("li",u).removeClass(o.ACTIVE).index(g(a)),b(g(a)).addClass(o.ACTIVE))}).click(function(f){b(g(f)).addClass(o.ACTIVE);c();a.focus();return!1}).mousedown(function(){f.mouseDownOnSelect=!0}).mouseup(function(){f.mouseDownOnSelect=!1}),l.width>0&&s.css("width",l.width),t=!1)}function g(a){for(a=a.target;a&&a.tagName!="LI";)a=a.parentNode;if(!a)return[];return a}function h(a){n.slice(r,
r+1).removeClass(o.ACTIVE);r+=a;r<0?r=n.size()-1:r>=n.size()&&(r=0);a=n.slice(r,r+1).addClass(o.ACTIVE);if(l.scroll){var c=0;n.slice(0,r).each(function(){c+=this.offsetHeight});c+a[0].offsetHeight-u.scrollTop()>u[0].clientHeight?u.scrollTop(c+a[0].offsetHeight-u.innerHeight()):c<u.scrollTop()&&u.scrollTop(c)}}var o={ACTIVE:"ac_over"},n,r=-1,p,q="",t=!0,s,u;return{display:function(a,c){m();p=a;q=c;u.empty();for(var f=l.max&&l.max<p.length?l.max:p.length,g=0;g<f;g++)if(p[g]){var h=l.formatItem(p[g].data,
g+1,f,p[g].value,q);h!==!1&&(h=b("<li/>").html(l.highlight(h,q)).addClass(g%2==0?"ac_even":"ac_odd").appendTo(u)[0],b.data(h,"ac_data",p[g]))}n=u.find("li");l.selectFirst&&(n.slice(0,1).addClass(o.ACTIVE),r=0);b.fn.bgiframe&&u.bgiframe()},next:function(){h(1)},prev:function(){h(-1)},pageUp:function(){r!=0&&r-8<0?h(-r):h(-8)},pageDown:function(){r!=n.size()-1&&r+8>n.size()?h(n.size()-1-r):h(8)},hide:function(){s&&s.hide();n&&n.removeClass(o.ACTIVE);r=-1},visible:function(){return s&&s.is(":visible")},
current:function(){return this.visible()&&(n.filter("."+o.ACTIVE)[0]||l.selectFirst&&n[0])},show:function(){var c=b(a).offset();s.css({width:typeof l.width=="string"||l.width>0?l.width:b(a).width(),top:c.top+a.offsetHeight,left:c.left}).show();if(l.scroll&&(u.scrollTop(0),u.css({maxHeight:l.scrollHeight,overflow:"auto"}),b.browser.msie&&typeof document.body.style.maxHeight==="undefined")){var f=0;n.each(function(){f+=this.offsetHeight});c=f>l.scrollHeight;u.css("height",c?l.scrollHeight:f);c||n.width(u.width()-
parseInt(n.css("padding-left"))-parseInt(n.css("padding-right")))}},selected:function(){var a=n&&n.filter("."+o.ACTIVE).removeClass(o.ACTIVE);return a&&a.length&&b.data(a[0],"ac_data")},emptyList:function(){u&&u.empty()},unbind:function(){s&&s.remove()}}};b.fn.selection=function(b,a){if(b!==void 0)return this.each(function(){if(this.createTextRange){var c=this.createTextRange();a===void 0||b==a?c.move("character",b):(c.collapse(!0),c.moveStart("character",b),c.moveEnd("character",a));c.select()}else if(this.setSelectionRange)this.setSelectionRange(b,
a);else if(this.selectionStart)this.selectionStart=b,this.selectionEnd=a});var c=this[0];if(c.createTextRange){var f=document.selection.createRange(),m=c.value,g=f.text.length;f.text="<->";f=c.value.indexOf("<->");c.value=m;this.selection(f,f+g);return{start:f,end:f+g}}else if(c.selectionStart!==void 0)return{start:c.selectionStart,end:c.selectionEnd}}})(jQuery);
(function(b){var l=[],a=[];b.fn.addTag=function(c,f){f=jQuery.extend({focus:!1,callback:!0},f);this.each(function(){id=b(this).attr("id");var m=b(this).val().split(l[id]);m[0]==""&&(m=[]);c=jQuery.trim(c);skipTag=f.unique?b(m).tagExist(c):!1;if(c!=""&&skipTag!=!0){b("<span>").addClass("tag").append(b("<span>").text(c).append("&nbsp;&nbsp;"),b("<a>",{href:"#",title:"Removing tag",text:"x"}).click(function(){return b("#"+id).removeTag(escape(c))})).insertBefore("#"+id+"_addTag");m.push(c);b("#"+id+
"_tag").val("");f.focus?b("#"+id+"_tag").focus():b("#"+id+"_tag").blur();if(f.callback&&a[id]&&a[id].onAddTag){var g=a[id].onAddTag;g(c)}if(a[id]&&a[id].onChange){var h=m.length,g=a[id].onChange;g(b(this),m[h])}}b.fn.tagsInput.updateTagsField(this,m)});return!1};b.fn.removeTag=function(c){c=unescape(c);this.each(function(){id=b(this).attr("id");var f=b(this).val().split(l[id]);b("#"+id+"_tagsinput .tag").remove();str="";for(i=0;i<f.length;i++)f[i]!=c&&(str=str+l[id]+f[i]);b.fn.tagsInput.importTags(this,
str);if(a[id]&&a[id].onRemoveTag)(0,a[id].onRemoveTag)(c)});return!1};b.fn.tagExist=function(a){return jQuery.inArray(a,b(this))==-1?!1:!0};b.fn.importTags=function(a){b("#"+id+"_tagsinput .tag").remove();b.fn.tagsInput.importTags(this,a)};b.fn.tagsInput=function(c){var f=jQuery.extend({interactive:!0,defaultText:"add a tag",minChars:0,autocomplete:{selectFirst:!1},hide:!0,delimiter:" ",unique:!0,removeWithBackspace:!0},c);this.each(function(){f.hide&&b(this).hide();id=b(this).attr("id");data=jQuery.extend({pid:id,
real_input:"#"+id,holder:"#"+id+"_tagsinput",input_wrapper:"#"+id+"_addTag",fake_input:"#"+id+"_tag"},f);l[id]=data.delimiter;if(f.onAddTag||f.onRemoveTag||f.onChange)a[id]=[],a[id].onAddTag=f.onAddTag,a[id].onRemoveTag=f.onRemoveTag,a[id].onChange=f.onChange;var c='<div id="'+id+'_tagsinput" class="tagsinput"><div id="'+id+'_addTag">';f.interactive&&(c=c+'<input id="'+id+'_tag" value="" data-default="'+f.defaultText+'" />');c+='</div><div class="tags_clear"></div></div>';b(c).insertAfter(this);b(data.holder).css("width",
f.width);b(data.holder).css("height",f.height);b(data.real_input).val()!=""&&b.fn.tagsInput.importTags(b(data.real_input),b(data.real_input).val());if(f.interactive){b(data.fake_input).val(b(data.fake_input).attr("data-default"));b(data.fake_input).css("color",f.placeholderColor);b(data.holder).bind("click",data,function(a){b(a.data.fake_input).focus()});b(data.fake_input).bind("focus",data,function(a){b(a.data.fake_input).val()==b(a.data.fake_input).attr("data-default")&&b(a.data.fake_input).val("");
b(a.data.fake_input).css("color","#000000")});if(f.autocomplete_url!=void 0){autocomplete_options={source:f.autocomplete_url};for(attrname in f.autocomplete)autocomplete_options[attrname]=f.autocomplete[attrname];jQuery.Autocompleter!==void 0?(b(data.fake_input).autocomplete(f.autocomplete_url,f.autocomplete),b(data.fake_input).bind("result",data,function(a,c){c&&(d=c+"",b(a.data.real_input).addTag(d,{focus:!0,unique:f.unique}))})):jQuery.ui.autocomplete!==void 0&&(b(data.fake_input).autocomplete(autocomplete_options),
b(data.fake_input).bind("autocompleteselect",data,function(a,c){b(a.data.real_input).addTag(c.item.value,{focus:!0,unique:f.unique});return!1}))}else b(data.fake_input).bind("blur",data,function(a){var c=b(this).attr("data-default");b(a.data.fake_input).val()!=""&&b(a.data.fake_input).val()!=c?a.data.minChars<=b(a.data.fake_input).val().length&&(!a.data.maxChars||a.data.maxChars>=b(a.data.fake_input).val().length)&&b(a.data.real_input).addTag(b(a.data.fake_input).val(),{focus:!0,unique:f.unique}):
(b(a.data.fake_input).val(b(a.data.fake_input).attr("data-default")),b(a.data.fake_input).css("color",f.placeholderColor));return!1});b(data.fake_input).bind("keypress",data,function(a){if(a.which==a.data.delimiter.charCodeAt(0)||a.which==13)return a.data.minChars<=b(a.data.fake_input).val().length&&(!a.data.maxChars||a.data.maxChars>=b(a.data.fake_input).val().length)&&b(a.data.real_input).addTag(b(a.data.fake_input).val(),{focus:!0,unique:f.unique}),!1});data.removeWithBackspace&&b(data.fake_input).bind("keydown",
function(a){if(a.keyCode==8&&b(this).val()==""){a.preventDefault();var a=b(this).closest(".tagsinput").find(".tag:last").text(),c=b(this).attr("id").replace(/_tag$/,""),a=a.replace(/[\s]+x$/,"");b("#"+c).removeTag(escape(a));b(this).trigger("focus")}});b(data.fake_input).blur()}return!1});return this};b.fn.tagsInput.updateTagsField=function(a,f){id=b(a).attr("id");b(a).val(f.join(l[id]))};b.fn.tagsInput.importTags=function(c,f){b(c).val("");id=b(c).attr("id");var m=f.split(l[id]);for(i=0;i<m.length;i++)b(c).addTag(m[i],
{focus:!1,callback:!1});if(a[id]&&a[id].onChange)(0,a[id].onChange)(c,m[i])}})(jQuery);
(function(b){b.fn.autoSuggest=function(l,a){var c=b.extend({asHtmlID:!1,startText:"Enter Name Here",emptyText:"No Results Found",preFill:{},limitText:"No More Selections Are Allowed",selectedItemProp:"value",selectedValuesProp:"value",searchObjProps:"value",queryParam:"q",retrieveLimit:!1,extraParams:"",matchCase:!1,minChars:1,keyDelay:400,resultsHighlight:!0,neverSubmit:!1,selectionLimit:!1,showResultList:!0,start:function(){},selectionClick:function(){},selectionAdded:function(){},selectionRemoved:function(a){a.remove()},
formatList:!1,beforeRetrieve:function(a){return a},retrieveComplete:function(a){return a},resultClick:function(){},resultsComplete:function(){}},a),f="object",m=0;if(typeof l=="string")var f="string",g=l;else{var h=l;for(k in l)l.hasOwnProperty(k)&&m++}if(f=="object"&&m>0||f=="string")return this.each(function(a){function n(){if(lastKeyPressCode==46||lastKeyPressCode>8&&lastKeyPressCode<32)return v.hide();var a=s.val().replace(/[\\]+|[\/]+/g,"");if(a!=E)if(E=a,a.length>=c.minChars)if(w.addClass("loading"),
f=="string"){var o="";c.retrieveLimit&&(o="&limit="+encodeURIComponent(c.retrieveLimit));c.beforeRetrieve&&(a=c.beforeRetrieve.call(this,a));b.getJSON(g+"?"+c.queryParam+"="+encodeURIComponent(a)+o+c.extraParams,function(f){m=0;f=c.retrieveComplete.call(this,f);for(k in f)f.hasOwnProperty(k)&&m++;l(f,a)})}else c.beforeRetrieve&&(a=c.beforeRetrieve.call(this,a)),l(h,a);else w.removeClass("loading"),v.hide()}function l(a,f){c.matchCase||(f=f.toLowerCase());var g=0;v.html(y.html("")).hide();for(var h=
0;h<m;h++){var o=h;F++;var n=!1;if(c.searchObjProps=="value")var r=a[o].value;else for(var r="",q=c.searchObjProps.split(","),t=0;t<q.length;t++)var z=b.trim(q[t]),r=r+a[o][z]+" ";r&&(c.matchCase||(r=r.toLowerCase()),r.search(f)!=-1&&x.val().search(","+a[o][c.selectedValuesProp]+",")==-1&&(n=!0));if(n&&(n=b('<li class="as-result-item" id="as-result-item-'+o+'"></li>').click(function(){var a=b(this).data("data"),f=a.num;if(b("#as-selection-"+f,w).length<=0&&!D){var g=a.attributes;s.val("").focus();
E="";p(g,f);c.resultClick.call(this,a);v.hide()}D=!1}).mousedown(function(){u=!1}).mouseover(function(){b("li",y).removeClass("active");b(this).addClass("active")}).data("data",{attributes:a[o],num:F}),o=b.extend({},a[o]),r=c.matchCase?RegExp("(?![^&;]+;)(?!<[^<>]*)("+f+")(?![^<>]*>)(?![^&;]+;)","g"):RegExp("(?![^&;]+;)(?!<[^<>]*)("+f+")(?![^<>]*>)(?![^&;]+;)","gi"),c.resultsHighlight&&(o[c.selectedItemProp]=o[c.selectedItemProp].replace(r,"<em>$1</em>")),n=c.formatList?c.formatList.call(this,o,n):
n.html(o[c.selectedItemProp]),y.append(n),delete o,g++,c.retrieveLimit&&c.retrieveLimit==g))break}w.removeClass("loading");g<=0&&y.html('<li class="as-message">'+c.emptyText+"</li>");y.css("width",w.outerWidth());v.show();c.resultsComplete.call(this)}function p(a,f){x.val(x.val()+a[c.selectedValuesProp]+",");var g=b('<li class="as-selection-item" id="as-selection-'+f+'"></li>').click(function(){c.selectionClick.call(this,b(this));w.children().removeClass("selected");b(this).addClass("selected")}).mousedown(function(){u=
!1}),m=b('<a class="as-close">&times;</a>').click(function(){x.val(x.val().replace(","+a[c.selectedValuesProp]+",",","));c.selectionRemoved.call(this,g);u=!0;s.focus();return!1});z.before(g.html(a[c.selectedItemProp]).prepend(m));c.selectionAdded.call(this,z.prev())}function q(a){if(b(":visible",v).length>0){var c=b("li",v),f=a=="down"?c.eq(0):c.filter(":last"),g=b("li.active:first",v);g.length>0&&(f=a=="down"?g.next():g.prev());c.removeClass("active");f.addClass("active")}}if(c.asHtmlID)t=a=c.asHtmlID;
else var a=a+""+Math.floor(Math.random()*100),t="as-input-"+a;c.start.call(this);var s=b(this);s.attr("autocomplete","off").addClass("as-input").attr("id",t).val(c.startText);var u=!1;s.wrap('<ul class="as-selections" id="as-selections-'+a+'"></ul>').wrap('<li class="as-original" id="as-original-'+a+'"></li>');var w=b("#as-selections-"+a),z=b("#as-original-"+a),v=b('<div class="as-results" id="as-results-'+a+'"></div>').hide(),y=b('<ul class="as-list"></ul>'),x=b('<input type="hidden" class="as-values" name="as_values_'+
a+'" id="as-values-'+a+'" />'),B="";if(typeof c.preFill=="string"){t=c.preFill.split(",");for(a=0;a<t.length;a++){var A={};A[c.selectedValuesProp]=t[a];t[a]!=""&&p(A,"000"+a)}B=c.preFill}else{B="";t=0;for(k in c.preFill)c.preFill.hasOwnProperty(k)&&t++;if(t>0)for(a=0;a<t;a++)A=c.preFill[a][c.selectedValuesProp],A==void 0&&(A=""),B=B+A+",",A!=""&&p(c.preFill[a],"000"+a)}B!=""&&(s.val(""),B.substring(B.length-1)!=","&&(B+=","),x.val(","+B),b("li.as-selection-item",w).addClass("blur").removeClass("selected"));
s.after(x);w.click(function(){u=!0;s.focus()}).mousedown(function(){u=!1}).after(v);var C=null,E="",D=!1;s.focus(function(){b(this).val()==c.startText&&x.val()==""?b(this).val(""):u&&(b("li.as-selection-item",w).removeClass("blur"),b(this).val()!=""&&(y.css("width",w.outerWidth()),v.show()));return u=!0}).blur(function(){b(this).val()==""&&x.val()==""&&B==""?b(this).val(c.startText):u&&(b("li.as-selection-item",w).addClass("blur").removeClass("selected"),v.hide())}).keydown(function(a){lastKeyPressCode=
a.keyCode;first_focus=!1;switch(a.keyCode){case 38:a.preventDefault();q("up");break;case 40:a.preventDefault();q("down");break;case 8:s.val()==""&&(a=x.val().split(","),a=a[a.length-2],w.children().not(z.prev()).removeClass("selected"),z.prev().hasClass("selected")?(x.val(x.val().replace(","+a+",",",")),c.selectionRemoved.call(this,z.prev())):(c.selectionClick.call(this,z.prev()),z.prev().addClass("selected")));s.val().length==1&&(v.hide(),E="");b(":visible",v).length>0&&(C&&clearTimeout(C),C=setTimeout(function(){n()},
c.keyDelay));break;case 9:case 188:D=!0;var f=s.val().replace(/(,)/g,"");if(f!=""&&x.val().search(","+f+",")<0&&f.length>=c.minChars){a.preventDefault();var g={};g[c.selectedItemProp]=f;g[c.selectedValuesProp]=f;f=b("li",w).length;p(g,"00"+(f+1));s.val("")}case 13:D=!1;g=b("li.active:first",v);g.length>0&&(g.click(),v.hide());(c.neverSubmit||g.length>0)&&a.preventDefault();break;default:c.showResultList&&(c.selectionLimit&&b("li.as-selection-item",w).length>=c.selectionLimit?(y.html('<li class="as-message">'+
c.limitText+"</li>"),v.show()):(C&&clearTimeout(C),C=setTimeout(function(){n()},c.keyDelay)))}});var F=0})}})(jQuery);
(function(b){function l(){var f;f=b(this);if(!f.data("timeago")){f.data("timeago",{datetime:c.datetime(f)});var m=b.trim(f.text());m.length>0&&f.attr("title",m)}f=f.data("timeago");isNaN(f.datetime)||b(this).text(a(f.datetime));return this}function a(a){return c.inWords((new Date).getTime()-a.getTime())}b.timeago=function(c){return c instanceof Date?a(c):typeof c==="string"?a(b.timeago.parse(c)):a(b.timeago.datetime(c))};var c=b.timeago;b.extend(b.timeago,{settings:{refreshMillis:6E4,allowFuture:!1,
strings:{prefixAgo:null,prefixFromNow:null,suffixAgo:"ago",suffixFromNow:"from now",seconds:"less than a minute",minute:"about a minute",minutes:"%d minutes",hour:"about an hour",hours:"about %d hours",day:"a day",days:"%d days",month:"about a month",months:"%d months",year:"about a year",years:"%d years",numbers:[]}},inWords:function(a){function c(m,h){return(b.isFunction(m)?m(h,a):m).replace(/%d/i,g.numbers&&g.numbers[h]||h)}var g=this.settings.strings,h=g.prefixAgo,o=g.suffixAgo;if(this.settings.allowFuture){if(a<
0)h=g.prefixFromNow,o=g.suffixFromNow;a=Math.abs(a)}var n=a/1E3,l=n/60,p=l/60,q=p/24,t=q/365,n=n<45&&c(g.seconds,Math.round(n))||n<90&&c(g.minute,1)||l<45&&c(g.minutes,Math.round(l))||l<90&&c(g.hour,1)||p<24&&c(g.hours,Math.round(p))||p<48&&c(g.day,1)||q<30&&c(g.days,Math.floor(q))||q<60&&c(g.month,1)||q<365&&c(g.months,Math.floor(q/30))||t<2&&c(g.year,1)||c(g.years,Math.floor(t));return b.trim([h,n,o].join(" "))},parse:function(a){a=b.trim(a);a=a.replace(/\.\d\d\d+/,"");a=a.replace(/-/,"/").replace(/-/,
"/");a=a.replace(/T/," ").replace(/Z/," UTC");a=a.replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2");return new Date(a)},datetime:function(a){a=b(a).get(0).tagName.toLowerCase()==="time"?b(a).attr("datetime"):b(a).attr("title");return c.parse(a)}});b.fn.timeago=function(){var a=this;a.each(l);var b=c.settings;b.refreshMillis>0&&setInterval(function(){a.each(l)},b.refreshMillis);return a};document.createElement("abbr");document.createElement("time")})(jQuery);
(function(b){function l(a){var f=[].slice.call(arguments,1),m=0,a=b.event.fix(a||window.event);a.type="mousewheel";a.wheelDelta&&(m=a.wheelDelta/120);a.detail&&(m=-a.detail/3);f.unshift(a,m);return b.event.handle.apply(this,f)}var a=["DOMMouseScroll","mousewheel"];b.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var c=a.length;c;)this.addEventListener(a[--c],l,!1);else this.onmousewheel=l},teardown:function(){if(this.removeEventListener)for(var c=a.length;c;)this.removeEventListener(a[--c],
l,!1);else this.onmousewheel=null}};b.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})})(jQuery);
(function(b){function l(a){if(typeof a.data==="string"){var c=a.handler,f=a.data.toLowerCase().split(" ");a.handler=function(a){if(!(this!==a.target&&(/textarea|select/i.test(a.target.nodeName)||a.target.type==="text"))){var g=a.type!=="keypress"&&b.hotkeys.specialKeys[a.which],h=String.fromCharCode(a.which).toLowerCase(),o="",n={};a.altKey&&g!=="alt"&&(o+="alt+");a.ctrlKey&&g!=="ctrl"&&(o+="ctrl+");a.metaKey&&!a.ctrlKey&&g!=="meta"&&(o+="meta+");a.shiftKey&&g!=="shift"&&(o+="shift+");g?n[o+g]=!0:
(n[o+h]=!0,n[o+b.hotkeys.shiftNums[h]]=!0,o==="shift+"&&(n[b.hotkeys.shiftNums[h]]=!0));g=0;for(h=f.length;g<h;g++)if(n[f[g]])return c.apply(this,arguments)}}}}b.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",
109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",191:"/",224:"meta"},shiftNums:{"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"}};b.each(["keydown","keyup","keypress"],function(){b.event.special[this]={add:l}})})(jQuery);
(function(){function b(){this.Diff_Timeout=1;this.Diff_EditCost=4;this.Match_Threshold=0.5;this.Match_Distance=1E3;this.Patch_DeleteThreshold=0.5;this.Patch_Margin=4;this.Match_MaxBits=32}function l(){this.diffs=[];this.start2=this.start1=null;this.length2=this.length1=0}b.prototype.diff_main=function(a,c,f,b){typeof b=="undefined"&&(b=this.Diff_Timeout<=0?Number.MAX_VALUE:(new Date).getTime()+this.Diff_Timeout*1E3);if(a==null||c==null)throw Error("Null input. (diff_main)");if(a==c)return a?[[0,a]]:
[];typeof f=="undefined"&&(f=!0);var g=f,h=this.diff_commonPrefix(a,c),f=a.substring(0,h),a=a.substring(h),c=c.substring(h),h=this.diff_commonSuffix(a,c),o=a.substring(a.length-h),a=a.substring(0,a.length-h),c=c.substring(0,c.length-h),a=this.diff_compute_(a,c,g,b);f&&a.unshift([0,f]);o&&a.push([0,o]);this.diff_cleanupMerge(a);return a};b.prototype.diff_compute_=function(a,c,f,b){if(!a)return[[1,c]];if(!c)return[[-1,a]];var g=a.length>c.length?a:c,h=a.length>c.length?c:a,o=g.indexOf(h);return o!=
-1?(f=[[1,g.substring(0,o)],[0,h],[1,g.substring(o+h.length)]],a.length>c.length&&(f[0][0]=f[2][0]=-1),f):h.length==1?[[-1,a],[1,c]]:(g=this.diff_halfMatch_(a,c))?(h=g[0],a=g[1],o=g[2],c=g[3],g=g[4],h=this.diff_main(h,o,f,b),f=this.diff_main(a,c,f,b),h.concat([[0,g]],f)):f&&a.length>100&&c.length>100?this.diff_lineMode_(a,c,b):this.diff_bisect_(a,c,b)};b.prototype.diff_lineMode_=function(a,c,f){var b=this.diff_linesToChars_(a,c),a=b[0],c=b[1],b=b[2],a=this.diff_bisect_(a,c,f);this.diff_charsToLines_(a,
b);this.diff_cleanupSemantic(a);a.push([0,""]);for(var g=c=0,h=0,o=b="";c<a.length;){switch(a[c][0]){case 1:h++;o+=a[c][1];break;case -1:g++;b+=a[c][1];break;case 0:if(g>=1&&h>=1){b=this.diff_main(b,o,!1,f);a.splice(c-g-h,g+h);c=c-g-h;for(g=b.length-1;g>=0;g--)a.splice(c,0,b[g]);c+=b.length}g=h=0;o=b=""}c++}a.pop();return a};b.prototype.diff_bisect_=function(a,c,f){for(var b=a.length,g=c.length,h=Math.ceil((b+g)/2),o=2*h,n=Array(o),l=Array(o),p=0;p<o;p++)n[p]=-1,l[p]=-1;n[h+1]=0;l[h+1]=0;for(var p=
b-g,q=p%2!=0,t=0,s=0,u=0,w=0,z=0;z<h;z++){if((new Date).getTime()>f)break;for(var v=-z+t;v<=z-s;v+=2){var y=h+v,x;x=v==-z||v!=z&&n[y-1]<n[y+1]?n[y+1]:n[y-1]+1;for(var B=x-v;x<b&&B<g&&a.charAt(x)==c.charAt(B);)x++,B++;n[y]=x;if(x>b)s+=2;else if(B>g)t+=2;else if(q&&(y=h+p-v,y>=0&&y<o&&l[y]!=-1)){var A=b-l[y];if(x>=A)return this.diff_bisectSplit_(a,c,x,B,f)}}for(v=-z+u;v<=z-w;v+=2){y=h+v;A=v==-z||v!=z&&l[y-1]<l[y+1]?l[y+1]:l[y-1]+1;for(x=A-v;A<b&&x<g&&a.charAt(b-A-1)==c.charAt(g-x-1);)A++,x++;l[y]=A;
if(A>b)w+=2;else if(x>g)u+=2;else if(!q&&(y=h+p-v,y>=0&&y<o&&n[y]!=-1&&(x=n[y],B=h+x-y,A=b-A,x>=A)))return this.diff_bisectSplit_(a,c,x,B,f)}}return[[-1,a],[1,c]]};b.prototype.diff_bisectSplit_=function(a,c,f,b,g){var h=a.substring(0,f),o=c.substring(0,b),a=a.substring(f),c=c.substring(b),h=this.diff_main(h,o,!1,g),g=this.diff_main(a,c,!1,g);return h.concat(g)};b.prototype.diff_linesToChars_=function(a,c){function f(a){for(var c="",f=0,h=-1,o=b.length;h<a.length-1;){h=a.indexOf("\n",f);h==-1&&(h=
a.length-1);var l=a.substring(f,h+1),f=h+1;(g.hasOwnProperty?g.hasOwnProperty(l):g[l]!==void 0)?c+=String.fromCharCode(g[l]):(c+=String.fromCharCode(o),g[l]=o,b[o++]=l)}return c}var b=[],g={};b[0]="";var h=f(a),o=f(c);return[h,o,b]};b.prototype.diff_charsToLines_=function(a,c){for(var f=0;f<a.length;f++){for(var b=a[f][1],g=[],h=0;h<b.length;h++)g[h]=c[b.charCodeAt(h)];a[f][1]=g.join("")}};b.prototype.diff_commonPrefix=function(a,c){if(!a||!c||a.charAt(0)!=c.charAt(0))return 0;for(var f=0,b=Math.min(a.length,
c.length),g=b,h=0;f<g;)a.substring(h,g)==c.substring(h,g)?h=f=g:b=g,g=Math.floor((b-f)/2+f);return g};b.prototype.diff_commonSuffix=function(a,c){if(!a||!c||a.charAt(a.length-1)!=c.charAt(c.length-1))return 0;for(var b=0,m=Math.min(a.length,c.length),g=m,h=0;b<g;)a.substring(a.length-g,a.length-h)==c.substring(c.length-g,c.length-h)?h=b=g:m=g,g=Math.floor((m-b)/2+b);return g};b.prototype.diff_commonOverlap_=function(a,c){var b=a.length,m=c.length;if(b==0||m==0)return 0;b>m?a=a.substring(b-m):b<m&&
(c=c.substring(0,b));b=Math.min(b,m);if(a==c)return b;for(var m=0,g=1;;){var h=a.substring(b-g),h=c.indexOf(h);if(h==-1)return m;g+=h;if(h==0||a.substring(b-g)==c.substring(0,g))m=g,g++}};b.prototype.diff_halfMatch_=function(a,c){function b(a,c,f){for(var g=a.substring(f,f+Math.floor(a.length/4)),m=-1,o="",n,l,r,x;(m=c.indexOf(g,m+1))!=-1;){var B=h.diff_commonPrefix(a.substring(f),c.substring(m)),A=h.diff_commonSuffix(a.substring(0,f),c.substring(0,m));o.length<A+B&&(o=c.substring(m-A,m)+c.substring(m,
m+B),n=a.substring(0,f-A),l=a.substring(f+B),r=c.substring(0,m-A),x=c.substring(m+B))}return o.length*2>=a.length?[n,l,r,x,o]:null}if(this.Diff_Timeout<=0)return null;var m=a.length>c.length?a:c,g=a.length>c.length?c:a;if(m.length<4||g.length*2<m.length)return null;var h=this,o=b(m,g,Math.ceil(m.length/4)),m=b(m,g,Math.ceil(m.length/2)),n;if(!o&&!m)return null;else n=m?o?o[4].length>m[4].length?o:m:m:o;var l;a.length>c.length?(o=n[0],m=n[1],g=n[2],l=n[3]):(g=n[0],l=n[1],o=n[2],m=n[3]);n=n[4];return[o,
m,g,l,n]};b.prototype.diff_cleanupSemantic=function(a){for(var c=!1,b=[],m=0,g=null,h=0,o=0,n=0,l=0,p=0;h<a.length;)a[h][0]==0?(b[m++]=h,o=l,n=p,p=l=0,g=a[h][1]):(a[h][0]==1?l+=a[h][1].length:p+=a[h][1].length,g!==null&&g.length<=Math.max(o,n)&&g.length<=Math.max(l,p)&&(a.splice(b[m-1],0,[-1,g]),a[b[m-1]+1][0]=1,m--,m--,h=m>0?b[m-1]:-1,p=l=n=o=0,g=null,c=!0)),h++;c&&this.diff_cleanupMerge(a);this.diff_cleanupSemanticLossless(a);for(h=1;h<a.length;){if(a[h-1][0]==-1&&a[h][0]==1){c=a[h-1][1];b=a[h][1];
m=this.diff_commonOverlap_(c,b);if(m>=c.length/2||m>=b.length/2)a.splice(h,0,[0,b.substring(0,m)]),a[h-1][1]=c.substring(0,c.length-m),a[h+1][1]=b.substring(m),h++;h++}h++}};b.prototype.diff_cleanupSemanticLossless=function(a){function c(a,c){if(!a||!c)return 5;var l=0;if(a.charAt(a.length-1).match(b)||c.charAt(0).match(b))if(l++,a.charAt(a.length-1).match(m)||c.charAt(0).match(m))if(l++,a.charAt(a.length-1).match(g)||c.charAt(0).match(g))l++,(a.match(h)||c.match(o))&&l++;return l}for(var b=/[^a-zA-Z0-9]/,
m=/\s/,g=/[\r\n]/,h=/\n\r?\n$/,o=/^\r?\n\r?\n/,n=1;n<a.length-1;){if(a[n-1][0]==0&&a[n+1][0]==0){var l=a[n-1][1],p=a[n][1],q=a[n+1][1],t=this.diff_commonSuffix(l,p);if(t)var s=p.substring(p.length-t),l=l.substring(0,l.length-t),p=s+p.substring(0,p.length-t),q=s+q;for(var t=l,s=p,u=q,w=c(l,p)+c(p,q);p.charAt(0)===q.charAt(0);){l+=p.charAt(0);var p=p.substring(1)+q.charAt(0),q=q.substring(1),z=c(l,p)+c(p,q);z>=w&&(w=z,t=l,s=p,u=q)}a[n-1][1]!=t&&(t?a[n-1][1]=t:(a.splice(n-1,1),n--),a[n][1]=s,u?a[n+1][1]=
u:(a.splice(n+1,1),n--))}n++}};b.prototype.diff_cleanupEfficiency=function(a){for(var c=!1,b=[],m=0,g="",h=0,o=!1,l=!1,r=!1,p=!1;h<a.length;){if(a[h][0]==0)a[h][1].length<this.Diff_EditCost&&(r||p)?(b[m++]=h,o=r,l=p,g=a[h][1]):(m=0,g=""),r=p=!1;else if(a[h][0]==-1?p=!0:r=!0,g&&(o&&l&&r&&p||g.length<this.Diff_EditCost/2&&o+l+r+p==3))a.splice(b[m-1],0,[-1,g]),a[b[m-1]+1][0]=1,m--,g="",o&&l?(r=p=!0,m=0):(m--,h=m>0?b[m-1]:-1,r=p=!1),c=!0;h++}c&&this.diff_cleanupMerge(a)};b.prototype.diff_cleanupMerge=
function(a){a.push([0,""]);for(var c=0,b=0,m=0,g="",h="",o;c<a.length;)switch(a[c][0]){case 1:m++;h+=a[c][1];c++;break;case -1:b++;g+=a[c][1];c++;break;case 0:b+m>1?(b!==0&&m!==0&&(o=this.diff_commonPrefix(h,g),o!==0&&(c-b-m>0&&a[c-b-m-1][0]==0?a[c-b-m-1][1]+=h.substring(0,o):(a.splice(0,0,[0,h.substring(0,o)]),c++),h=h.substring(o),g=g.substring(o)),o=this.diff_commonSuffix(h,g),o!==0&&(a[c][1]=h.substring(h.length-o)+a[c][1],h=h.substring(0,h.length-o),g=g.substring(0,g.length-o))),b===0?a.splice(c-
b-m,b+m,[1,h]):m===0?a.splice(c-b-m,b+m,[-1,g]):a.splice(c-b-m,b+m,[-1,g],[1,h]),c=c-b-m+(b?1:0)+(m?1:0)+1):c!==0&&a[c-1][0]==0?(a[c-1][1]+=a[c][1],a.splice(c,1)):c++,b=m=0,h=g=""}a[a.length-1][1]===""&&a.pop();b=!1;for(c=1;c<a.length-1;)a[c-1][0]==0&&a[c+1][0]==0&&(a[c][1].substring(a[c][1].length-a[c-1][1].length)==a[c-1][1]?(a[c][1]=a[c-1][1]+a[c][1].substring(0,a[c][1].length-a[c-1][1].length),a[c+1][1]=a[c-1][1]+a[c+1][1],a.splice(c-1,1),b=!0):a[c][1].substring(0,a[c+1][1].length)==a[c+1][1]&&
(a[c-1][1]+=a[c+1][1],a[c][1]=a[c][1].substring(a[c+1][1].length)+a[c+1][1],a.splice(c+1,1),b=!0)),c++;b&&this.diff_cleanupMerge(a)};b.prototype.diff_xIndex=function(a,c){var b=0,m=0,g=0,h=0,o;for(o=0;o<a.length;o++){a[o][0]!==1&&(b+=a[o][1].length);a[o][0]!==-1&&(m+=a[o][1].length);if(b>c)break;g=b;h=m}return a.length!=o&&a[o][0]===-1?h:h+(c-g)};b.prototype.diff_prettyHtml=function(a){for(var c=[],b=0,m=/&/g,g=/</g,h=/>/g,o=/\n/g,l=0;l<a.length;l++){var r=a[l][0],p=a[l][1],q=p.replace(m,"&amp;").replace(g,
"&lt;").replace(h,"&gt;").replace(o,"&para;<br>");switch(r){case 1:c[l]='<ins style="background:#e6ffe6;">'+q+"</ins>";break;case -1:c[l]='<del style="background:#ffe6e6;">'+q+"</del>";break;case 0:c[l]="<span>"+q+"</span>"}r!==-1&&(b+=p.length)}return c.join("")};b.prototype.diff_text1=function(a){for(var c=[],b=0;b<a.length;b++)a[b][0]!==1&&(c[b]=a[b][1]);return c.join("")};b.prototype.diff_text2=function(a){for(var c=[],b=0;b<a.length;b++)a[b][0]!==-1&&(c[b]=a[b][1]);return c.join("")};b.prototype.diff_levenshtein=
function(a){for(var c=0,b=0,m=0,g=0;g<a.length;g++){var h=a[g][1];switch(a[g][0]){case 1:b+=h.length;break;case -1:m+=h.length;break;case 0:c+=Math.max(b,m),m=b=0}}c+=Math.max(b,m);return c};b.prototype.diff_toDelta=function(a){for(var c=[],b=0;b<a.length;b++)switch(a[b][0]){case 1:c[b]="+"+encodeURI(a[b][1]);break;case -1:c[b]="-"+a[b][1].length;break;case 0:c[b]="="+a[b][1].length}return c.join("\t").replace(/%20/g," ")};b.prototype.diff_fromDelta=function(a,c){for(var b=[],m=0,g=0,h=c.split(/\t/g),
l=0;l<h.length;l++){var n=h[l].substring(1);switch(h[l].charAt(0)){case "+":try{b[m++]=[1,decodeURI(n)]}catch(r){throw Error("Illegal escape in diff_fromDelta: "+n);}break;case "-":case "=":var p=parseInt(n,10);if(isNaN(p)||p<0)throw Error("Invalid number in diff_fromDelta: "+n);n=a.substring(g,g+=p);h[l].charAt(0)=="="?b[m++]=[0,n]:b[m++]=[-1,n];break;default:if(h[l])throw Error("Invalid diff operation in diff_fromDelta: "+h[l]);}}if(g!=a.length)throw Error("Delta length ("+g+") does not equal source text length ("+
a.length+").");return b};b.prototype.match_main=function(a,c,b){if(a==null||c==null||b==null)throw Error("Null input. (match_main)");b=Math.max(0,Math.min(b,a.length));return a==c?0:a.length?a.substring(b,b+c.length)==c?b:this.match_bitap_(a,c,b):-1};b.prototype.match_bitap_=function(a,c,b){function m(a,g){var m=a/c.length,l=Math.abs(b-g);return!h.Match_Distance?l?1:m:m+l/h.Match_Distance}if(c.length>this.Match_MaxBits)throw Error("Pattern too long for this browser.");var g=this.match_alphabet_(c),
h=this,l=this.Match_Threshold,n=a.indexOf(c,b);n!=-1&&(l=Math.min(m(0,n),l),n=a.lastIndexOf(c,b+c.length),n!=-1&&(l=Math.min(m(0,n),l)));for(var r=1<<c.length-1,n=-1,p,q,t=c.length+a.length,s,u=0;u<c.length;u++){p=0;for(q=t;p<q;)m(u,b+q)<=l?p=q:t=q,q=Math.floor((t-p)/2+p);t=q;p=Math.max(1,b-q+1);var w=Math.min(b+q,a.length)+c.length;q=Array(w+2);for(q[w+1]=(1<<u)-1;w>=p;w--){var z=g[a.charAt(w-1)];q[w]=u===0?(q[w+1]<<1|1)&z:(q[w+1]<<1|1)&z|(s[w+1]|s[w])<<1|1|s[w+1];if(q[w]&r&&(z=m(u,w-1),z<=l))if(l=
z,n=w-1,n>b)p=Math.max(1,2*b-n);else break}if(m(u+1,b)>l)break;s=q}return n};b.prototype.match_alphabet_=function(a){for(var c={},b=0;b<a.length;b++)c[a.charAt(b)]=0;for(b=0;b<a.length;b++)c[a.charAt(b)]|=1<<a.length-b-1;return c};b.prototype.patch_addContext_=function(a,b){if(b.length!=0){for(var f=b.substring(a.start2,a.start2+a.length1),m=0;b.indexOf(f)!=b.lastIndexOf(f)&&f.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)m+=this.Patch_Margin,f=b.substring(a.start2-m,a.start2+a.length1+
m);m+=this.Patch_Margin;(f=b.substring(a.start2-m,a.start2))&&a.diffs.unshift([0,f]);(m=b.substring(a.start2+a.length1,a.start2+a.length1+m))&&a.diffs.push([0,m]);a.start1-=f.length;a.start2-=f.length;a.length1+=f.length+m.length;a.length2+=f.length+m.length}};b.prototype.patch_make=function(a,b,f){var m;if(typeof a=="string"&&typeof b=="string"&&typeof f=="undefined")m=a,b=this.diff_main(m,b,!0),b.length>2&&(this.diff_cleanupSemantic(b),this.diff_cleanupEfficiency(b));else if(a&&typeof a=="object"&&
typeof b=="undefined"&&typeof f=="undefined")b=a,m=this.diff_text1(b);else if(typeof a=="string"&&b&&typeof b=="object"&&typeof f=="undefined")m=a;else if(typeof a=="string"&&typeof b=="string"&&f&&typeof f=="object")m=a,b=f;else throw Error("Unknown call format to patch_make.");if(b.length===0)return[];for(var f=[],a=new l,g=0,h=0,o=0,n=m,r=0;r<b.length;r++){var p=b[r][0],q=b[r][1];if(!g&&p!==0)a.start1=h,a.start2=o;switch(p){case 1:a.diffs[g++]=b[r];a.length2+=q.length;m=m.substring(0,o)+q+m.substring(o);
break;case -1:a.length1+=q.length;a.diffs[g++]=b[r];m=m.substring(0,o)+m.substring(o+q.length);break;case 0:q.length<=2*this.Patch_Margin&&g&&b.length!=r+1?(a.diffs[g++]=b[r],a.length1+=q.length,a.length2+=q.length):q.length>=2*this.Patch_Margin&&g&&(this.patch_addContext_(a,n),f.push(a),a=new l,g=0,n=m,h=o)}p!==1&&(h+=q.length);p!==-1&&(o+=q.length)}g&&(this.patch_addContext_(a,n),f.push(a));return f};b.prototype.patch_deepCopy=function(a){for(var b=[],f=0;f<a.length;f++){var m=a[f],g=new l;g.diffs=
[];for(var h=0;h<m.diffs.length;h++)g.diffs[h]=m.diffs[h].slice();g.start1=m.start1;g.start2=m.start2;g.length1=m.length1;g.length2=m.length2;b[f]=g}return b};b.prototype.patch_apply=function(a,b){if(a.length==0)return[b,[]];var a=this.patch_deepCopy(a),f=this.patch_addPadding(a),b=f+b+f;this.patch_splitMax(a);for(var m=0,g=[],h=0;h<a.length;h++){var l=a[h].start2+m,n=this.diff_text1(a[h].diffs),r,p=-1;if(n.length>this.Match_MaxBits){if(r=this.match_main(b,n.substring(0,this.Match_MaxBits),l),r!=
-1&&(p=this.match_main(b,n.substring(n.length-this.Match_MaxBits),l+n.length-this.Match_MaxBits),p==-1||r>=p))r=-1}else r=this.match_main(b,n,l);if(r==-1)g[h]=!1,m-=a[h].length2-a[h].length1;else if(g[h]=!0,m=r-l,l=p==-1?b.substring(r,r+n.length):b.substring(r,p+this.Match_MaxBits),n==l)b=b.substring(0,r)+this.diff_text2(a[h].diffs)+b.substring(r+n.length);else if(l=this.diff_main(n,l,!1),n.length>this.Match_MaxBits&&this.diff_levenshtein(l)/n.length>this.Patch_DeleteThreshold)g[h]=!1;else{this.diff_cleanupSemanticLossless(l);
for(var n=0,q,p=0;p<a[h].diffs.length;p++){var t=a[h].diffs[p];t[0]!==0&&(q=this.diff_xIndex(l,n));t[0]===1?b=b.substring(0,r+q)+t[1]+b.substring(r+q):t[0]===-1&&(b=b.substring(0,r+q)+b.substring(r+this.diff_xIndex(l,n+t[1].length)));t[0]!==-1&&(n+=t[1].length)}}}b=b.substring(f.length,b.length-f.length);return[b,g]};b.prototype.patch_addPadding=function(a){for(var b=this.Patch_Margin,f="",l=1;l<=b;l++)f+=String.fromCharCode(l);for(l=0;l<a.length;l++)a[l].start1+=b,a[l].start2+=b;var l=a[0],g=l.diffs;
if(g.length==0||g[0][0]!=0)g.unshift([0,f]),l.start1-=b,l.start2-=b,l.length1+=b,l.length2+=b;else if(b>g[0][1].length){var h=b-g[0][1].length;g[0][1]=f.substring(g[0][1].length)+g[0][1];l.start1-=h;l.start2-=h;l.length1+=h;l.length2+=h}l=a[a.length-1];g=l.diffs;g.length==0||g[g.length-1][0]!=0?(g.push([0,f]),l.length1+=b,l.length2+=b):b>g[g.length-1][1].length&&(h=b-g[g.length-1][1].length,g[g.length-1][1]+=f.substring(0,h),l.length1+=h,l.length2+=h);return f};b.prototype.patch_splitMax=function(a){for(var b=
this.Match_MaxBits,f=0;f<a.length;f++)if(a[f].length1>b){var m=a[f];a.splice(f--,1);for(var g=m.start1,h=m.start2,o="";m.diffs.length!==0;){var n=new l,r=!0;n.start1=g-o.length;n.start2=h-o.length;if(o!=="")n.length1=n.length2=o.length,n.diffs.push([0,o]);for(;m.diffs.length!==0&&n.length1<b-this.Patch_Margin;){var o=m.diffs[0][0],p=m.diffs[0][1];o===1?(n.length2+=p.length,h+=p.length,n.diffs.push(m.diffs.shift()),r=!1):o===-1&&n.diffs.length==1&&n.diffs[0][0]==0&&p.length>2*b?(n.length1+=p.length,
g+=p.length,r=!1,n.diffs.push([o,p]),m.diffs.shift()):(p=p.substring(0,b-n.length1-this.Patch_Margin),n.length1+=p.length,g+=p.length,o===0?(n.length2+=p.length,h+=p.length):r=!1,n.diffs.push([o,p]),p==m.diffs[0][1]?m.diffs.shift():m.diffs[0][1]=m.diffs[0][1].substring(p.length))}o=this.diff_text2(n.diffs);o=o.substring(o.length-this.Patch_Margin);p=this.diff_text1(m.diffs).substring(0,this.Patch_Margin);p!==""&&(n.length1+=p.length,n.length2+=p.length,n.diffs.length!==0&&n.diffs[n.diffs.length-1][0]===
0?n.diffs[n.diffs.length-1][1]+=p:n.diffs.push([0,p]));r||a.splice(++f,0,n)}}};b.prototype.patch_toText=function(a){for(var b=[],f=0;f<a.length;f++)b[f]=a[f];return b.join("")};b.prototype.patch_fromText=function(a){var b=[];if(!a)return b;for(var a=a.split("\n"),f=0,m=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;f<a.length;){var g=a[f].match(m);if(!g)throw Error("Invalid patch string: "+a[f]);var h=new l;b.push(h);h.start1=parseInt(g[1],10);g[2]===""?(h.start1--,h.length1=1):g[2]=="0"?h.length1=0:(h.start1--,
h.length1=parseInt(g[2],10));h.start2=parseInt(g[3],10);g[4]===""?(h.start2--,h.length2=1):g[4]=="0"?h.length2=0:(h.start2--,h.length2=parseInt(g[4],10));for(f++;f<a.length;){g=a[f].charAt(0);try{var o=decodeURI(a[f].substring(1))}catch(n){throw Error("Illegal escape in patch_fromText: "+o);}if(g=="-")h.diffs.push([-1,o]);else if(g=="+")h.diffs.push([1,o]);else if(g==" ")h.diffs.push([0,o]);else if(g=="@")break;else if(g!=="")throw Error('Invalid patch mode "'+g+'" in: '+o);f++}}return b};l.prototype.toString=
function(){var a,b;a=this.length1===0?this.start1+",0":this.length1==1?this.start1+1:this.start1+1+","+this.length1;b=this.length2===0?this.start2+",0":this.length2==1?this.start2+1:this.start2+1+","+this.length2;a=["@@ -"+a+" +"+b+" @@\n"];var f;for(b=0;b<this.diffs.length;b++){switch(this.diffs[b][0]){case 1:f="+";break;case -1:f="-";break;case 0:f=" "}a[b+1]=f+encodeURI(this.diffs[b][1])+"\n"}return a.join("").replace(/%20/g," ")};window.diff_match_patch=b;window.patch_obj=l;window.DIFF_DELETE=
-1;window.DIFF_INSERT=1;window.DIFF_EQUAL=0})();var Attacklab=Attacklab||{};Attacklab.showdown=Attacklab.showdown||{};
Attacklab.showdown.converter=function(){var b=function(){this.set=function(a,b){this["s_"+a]=b};this.get=function(a){return this["s_"+a]}},l,a,c,f=0;this.makeHtml=function(f){l=new b;a=new b;c=[];f=f.replace(/~/g,"~T");f=f.replace(/\$/g,"~D");f=f.replace(/\r\n/g,"\n");f=f.replace(/\r/g,"\n");f=I("\n\n"+f+"\n\n");f=f.replace(/^[ \t]+$/mg,"");f=g(f);f=m(f);f=o(f);f=D(f);f=f.replace(/~D/g,"$$");return f.replace(/~T/g,"~")};var m=function(b){return b=b.replace(/^[ ]{0,3}\[(.+)\]:[ \t]*\n?[ \t]*<?(\S+?)>?(?=\s|$)[ \t]*\n?[ \t]*((\n*)["(](.+?)[")][ \t]*)?(?:\n+)/gm,
function(b,c,f,g,h,m){c=c.toLowerCase();l.set(c,A(f));if(h)return g;else m&&a.set(c,m.replace(/"/g,"&quot;"));return""})},g=function(a){a=a.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del)\b[^\r]*?\n<\/\2>[ \t]*(?=\n+))/gm,h);a=a.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math)\b[^\r]*?.*<\/\2>[ \t]*(?=\n+)\n)/gm,h);a=a.replace(/\n[ ]{0,3}((<(hr)\b([^<>])*?\/?>)[ \t]*(?=\n{2,}))/g,h);a=a.replace(/\n\n[ ]{0,3}(<!(--(?:|(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)>[ \t]*(?=\n{2,}))/g,
h);return a.replace(/(?:\n\n)([ ]{0,3}(?:<([?%])[^\r]*?\2>)[ \t]*(?=\n{2,}))/g,h)},h=function(a,b){var f;f=b.replace(/^\n+/,"");f=f.replace(/\n+$/g,"");return"\n\n~K"+(c.push(f)-1)+"K\n\n"},o=function(a,b){for(var a=t(a),f=v("<hr />"),a=a.replace(/^[ ]{0,2}([ ]?\*[ ]?){3,}[ \t]*$/gm,f),a=a.replace(/^[ ]{0,2}([ ]?-[ ]?){3,}[ \t]*$/gm,f),a=a.replace(/^[ ]{0,2}([ ]?_[ ]?){3,}[ \t]*$/gm,f),a=u(a),a=z(a),a=B(a),a=g(a),f=a.replace(/^\n+/g,""),f=f.replace(/\n+$/g,""),h=f.split(/\n{2,}/g),f=[],l=h.length,
m=0;m<l;m++){var o=h[m];o.search(/~K(\d+)K/g)>=0?f.push(o):o.search(/\S/)>=0&&(o=n(o),o=o.replace(/^([ \t]*)/g,"<p>"),o+="</p>",f.push(o))}if(!b){l=f.length;for(m=0;m<l;m++)for(;f[m].search(/~K(\d+)K/)>=0;)h=c[RegExp.$1],h=h.replace(/\$/g,"$$$$"),f[m]=f[m].replace(/~K\d+K/,h)}return f.join("\n\n")},n=function(a){a=y(a);a=r(a);a=a.replace(/\\(\\)/g,H);a=a.replace(/\\([`*_{}\[\]()>#+-.!])/g,H);a=a.replace(/(!\[(.*?)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,q);a=a.replace(/(!\[(.*?)\]\s?\([ \t]*()<?(\S+?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,
q);a=a.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,p);a=a.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\]\([ \t]*()<?((?:\([^)]*\)|[^()])*?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,p);a=a.replace(/(\[([^\[\]]+)\])()()()()()/g,p);a=C(a);a=A(a);a=a.replace(/(\*\*|__)(?=\S)([^\r]*?\S[\*_]*)\1/g,"<strong>$2</strong>");a=a.replace(/(\*|_)(?=\S)([^\r]*?\S)\1/g,"<em>$2</em>");return a.replace(/  +\n/g," <br />\n")},r=function(a){return a=a.replace(/(<[a-z\/!$]("[^"]*"|'[^']*'|[^'">])*>|<!(--(?:|(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)>)/gi,
function(a){a=a.replace(/(.)<\/?code>(?=.)/g,"$1`");return G(a,"\\`*_")})},p=function(b,c,f,g,h,m,o,n){n==void 0&&(n="");b=g.toLowerCase();if(h=="")if(b==""&&(b=f.toLowerCase().replace(/ ?\n/g," ")),l.get(b)!=void 0)h=l.get(b),a.get(b)!=void 0&&(n=a.get(b));else if(c.search(/\(\s*\)$/m)>-1)h="";else return c;h=G(h,"*_");c='<a href="'+h+'"';n!=""&&(n=n.replace(/"/g,"&quot;"),n=G(n,"*_"),c+=' title="'+n+'"');c+=">"+f+"</a>";return c},q=function(b,c,f,g,h,m,o,n){b=f;g=g.toLowerCase();n||(n="");if(h==
"")if(g==""&&(g=b.toLowerCase().replace(/ ?\n/g," ")),l.get(g)!=void 0)h=l.get(g),a.get(g)!=void 0&&(n=a.get(g));else return c;b=b.replace(/"/g,"&quot;");h=G(h,"*_");c='<img src="'+h+'" alt="'+b+'"';n=n.replace(/"/g,"&quot;");n=G(n,"*_");c+=' title="'+n+'"';c+=" />";return c},t=function(a){a=a.replace(/^(.+)[ \t]*\n=+[ \t]*\n+/gm,function(a,b){return"<h1>"+n(b)+"</h1>\n\n"});a=a.replace(/^(.+)[ \t]*\n-+[ \t]*\n+/gm,function(a,b){return"<h2>"+n(b)+"</h2>\n\n"});return a=a.replace(/^(\#{1,6})[ \t]*(.+?)[ \t]*\#*\n+/gm,
function(a,b,c){a=b.length;return"<h"+a+">"+n(c)+"</h"+a+">\n\n"})},s,u=function(a){a+="~0";var b=/^(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm;f?a=a.replace(b,function(a,b,c){a=c.search(/[*+-]/g)>-1?"ul":"ol";b=s(b,a);b=b.replace(/\s+$/,"");return"<"+a+">"+b+"</"+a+">\n"}):(b=/(\n\n|^\n?)(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/g,a=a.replace(b,function(a,b,c,f){a=f.search(/[*+-]/g)>-1?"ul":"ol";c=s(c,
a);return b+"<"+a+">\n"+c+"</"+a+">\n"}));return a=a.replace(/~0/,"")},w={ol:"\\d+[.]",ul:"[*+-]"};s=function(a,b){f++;a=a.replace(/\n{2,}$/,"\n");a+="~0";var c=w[b],g=!1,a=a.replace(RegExp("(^[ \\t]*)("+c+")[ \\t]+([^\\r]+?(\\n+))(?=(~0|\\1("+c+")[ \\t]+))","gm"),function(a,b,c,f){a=f;(b=/\n\n$/.test(a))||a.search(/\n{2,}/)>-1||g?a=o(F(a),!0):(a=u(F(a)),a=a.replace(/\n$/,""),a=n(a));g=b;return"<li>"+a+"</li>\n"}),a=a.replace(/~0/g,"");f--;return a};var z=function(a){a+="~0";a=a.replace(/(?:\n\n|^)((?:(?:[ ]{4}|\t).*\n+)+)(\n*[ ]{0,3}[^ \t\n]|(?=~0))/g,
function(a,b,c){a=x(F(b));a=I(a);a=a.replace(/^\n+/g,"");a=a.replace(/\n+$/g,"");return"\n\n"+("<pre><code>"+a+"\n</code></pre>")+"\n\n"+c});return a=a.replace(/~0/,"")},v=function(a){a=a.replace(/(^\n+|\n+$)/g,"");return"\n\n~K"+(c.push(a)-1)+"K\n\n"},y=function(a){return a=a.replace(/(^|[^\\])(`+)([^\r]*?[^`])\2(?!`)/gm,function(a,b,c,f){a=f.replace(/^([ \t]*)/g,"");a=a.replace(/[ \t]*$/g,"");a=x(a);return b+"<code>"+a+"</code>"})},x=function(a){a=a.replace(/&/g,"&amp;");a=a.replace(/</g,"&lt;");
a=a.replace(/>/g,"&gt;");return G(a,"*_{}[]\\",!1)},B=function(a){return a=a.replace(/((^[ \t]*>[ \t]?.+\n(.+\n)*\n*)+)/gm,function(a,b){var c;c=b.replace(/^[ \t]*>[ \t]?/gm,"~0");c=c.replace(/~0/g,"");c=c.replace(/^[ \t]+$/gm,"");c=o(c);c=c.replace(/(^|\n)/g,"$1  ");c=c.replace(/(\s*<pre>[^\r]+?<\/pre>)/gm,function(a,b){return b.replace(/^  /mg,"~0").replace(/~0/g,"")});return v("<blockquote>\n"+c+"\n</blockquote>")})},A=function(a){a=a.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\w+);)/g,"&amp;");return a.replace(/<(?![a-z\/?\$!])/gi,
"&lt;")},C=function(a){a=a.replace(/<((https?|ftp|dict):[^'">\s]+)>/gi,'<a href="$1">$1</a>');return a=a.replace(/<(?:mailto:)?([-.\w]+\@[-a-z0-9]+(\.[-a-z0-9]+)*\.[a-z]+)>/gi,function(a,b){return E(D(b))})},E=function(a){var b=[function(a){return"&#"+a.charCodeAt(0)+";"},function(a){a=a.charCodeAt(0);return"&#x"+("0123456789ABCDEF".charAt(a>>4)+"0123456789ABCDEF".charAt(a&15))+";"},function(a){return a}],a=("mailto:"+a).replace(/./g,function(a){if(a=="@")a=b[Math.floor(Math.random()*2)](a);else if(a!=
":")var c=Math.random(),a=c>0.9?b[2](a):c>0.45?b[1](a):b[0](a);return a});return a=('<a href="'+a+'">'+a+"</a>").replace(/">.+:/g,'">')},D=function(a){return a=a.replace(/~E(\d+)E/g,function(a,b){var c=parseInt(b);return String.fromCharCode(c)})},F=function(a){a=a.replace(/^(\t|[ ]{1,4})/gm,"~0");return a.replace(/~0/g,"")},I=function(a){if(!/\t/.test(a))return a;var b=["    ","   ","  "," "],c=0,f;return a.replace(/[\n\t]/g,function(a,g){if(a==="\n")return c=g+1,a;f=(g-c)%4;c=g+1;return b[f]})},
G=function(a,b,c){b="(["+b.replace(/([\[\]\\])/g,"\\$1")+"])";c&&(b="\\\\"+b);return a.replace(RegExp(b,"g"),H)},H=function(a,b){return"~E"+b.charCodeAt(0)+"E"}};var Showdown=Attacklab.showdown;Attacklab.fileLoaded&&Attacklab.fileLoaded("showdown.js");var $=jQuery.noConflict();function getData(b){return storage=="localStorage"?localStorage[b]:sessionStorage[b]}function setData(b,l){storage=="localStorage"?localStorage[b]=l:sessionStorage[b]=l}
function reflowCards(){$(".current").length!=1&&($(".selected").length!=1?($(".selected").removeClass("selected"),$(".listnote:first").addClass("selected")):$("#"+$(".selected").data().key).addClass("current"));$(".prev2").removeClass("prev2");$(".prev1").removeClass("prev1");$(".next1").removeClass("next1");$(".next2").removeClass("next2");$(".current").prev(".note").prev(".note").addClass("prev2");$(".current").prev(".note").addClass("prev1");$(".current").next(".note").addClass("next1");$(".current").next(".note").next(".note").addClass("next2")}
function refreshCards(){$(".selected").length!=1&&($(".selected").removeClass("selected"),$(".listnote:first").addClass("selected"));$(".note").remove();$(".listnote:not(.hide)").each(function(){$("#note-template").clone().attr("id",$(this).data().key).addClass("note").appendTo(".window");var b=$("#"+$(this).data().key);b.children(".textarea").children("textarea").val($(this).data().content);var l=$(this).data().tags.join(" ");$.parseJSON(localStorage.tagIndex);b.children(".tag-area").children("input").attr("id",
"tag"+$(this).data().key).val(l).tagsInput()});$("#"+$(".selected").data().key).addClass("current");refreshNoteBinds(".note .textarea textarea");reflowCards()}function sortNotes(){$(".listnote").sortElements(function(b,l){if($(b).hasClass("pinned")){if(!$(l).hasClass("pinned"))return-1}else if($(l).hasClass("pinned")&&!$(b).hasClass("pinned"))return 1;return parseFloat($(b).data("modifydate"))<parseFloat($(l).data("modifydate"))?1:-1});return"sorted"}
function sortVersions(){$(".version-item").sortElements(function(b,l){return parseFloat($(b).data("version"))<parseFloat($(l).data("version"))?1:-1});return"sorted"}function diffVersions(b,l){var a=new diff_match_patch,c=a.diff_main(b,l);a.diff_cleanupSemantic(c);return a.diff_prettyHtml(c)}
function getNoteVersion(b,l){return $.Deferred(function(a){$.ajax("/sn.php",{type:"POST",data:{action:"noteversion",email:email,token:token,notekey:b,noteversion:l},success:function(c){note=$.parseJSON(c);$("#version-template").clone().attr("id",b+"version"+note.version).addClass("version-item").appendTo(".versions .versions-left").data(note);thisversion=$("#"+b+"version"+note.version);thisversion.children(".version-date").html('<abbr class="timeago" title="'+stackTime(note.versiondate)+'"></abbr>');
bindTimeago();sortVersions();a.resolve()},error:function(){return"false"}})}).promise()}
function populateVersions(b){$(".version-item").remove();var l=[];noteobj=$.parseJSON(localStorage.getItem(b));curversion=noteobj.version;for(i=minversion=noteobj.minversion;i<=curversion;i++)l.push(getNoteVersion(b,i));$.when.apply(null,l).done(function(){$(".version-item").each(function(){$(this).data().version>minversion&&(prev=$(this).data().version-1,ds=diffVersions($("#"+b+"version"+prev).data().content,$(this).data().content),$(this).data("diff",ds))});$(".versions-right .right-inner").html($(".version-item:first").data().diff);
$(".version-item:first").addClass("version-select")})}function getNote(b){return $.Deferred(function(l){$.ajax("/sn.php",{type:"POST",data:{action:"note",email:email,token:token,notekey:b},success:function(a){note=$.parseJSON(a);localStorage.setItem(note.key,a);localToDOM(note.key);l.resolve()},error:function(){}})}).promise()}
function sendNote(b){var l=$.Deferred(),a={action:"sendnote",email:email,token:token,notekey:b.key,notebody:JSON.stringify(b)};if(b.key.substr(0,9)=="notestack")delete a.notekey,delete b.key,a.notebody=JSON.stringify(b);$.ajax("/sn.php",{type:"POST",data:a,success:function(a){note=$.parseJSON(a);if(!("content"in note))note.content=b.content;index=$.parseJSON(localStorage.index);for(i=0;i<=index.data.length-1;i++)if(index.data[i].key.substr(0,9)=="notestack"){$("#list-"+index.data[i].key).remove();
localStorage.removeItem(index.data[i].key);index.data.splice(i,1);break}localStorage.index=JSON.stringify(index);localStorage.setItem(note.key,JSON.stringify(note));localToDOM(note.key);$("#list-"+note.key).addClass("selected");sortNotes();refreshCards();l.resolve()},error:function(){}});return l.promise()}function progressBar(b){$(".status .progress .inner").length==0&&$(".status").html('<div class="progress"><div class="inner"></div></div>');$(".status .progress .inner").css("width",b+"%")}
function updateAllNotes(){return $.Deferred(function(b){function l(h){for(a=c;a<=c+h;a++){progressBar(Math.round(100*(a/index.data.length)));if(!index.data[a]){console.log("broke at "+a);b.resolve();var o=!0;break}localStorage.getItem(index.data[a].key)?(localNote=$.parseJSON(localStorage.getItem(index.data[a].key)),localNote.key.substr(0,9)=="notestack"?f.push(sendNote(localNote)):localNote.syncnum<index.data[a].syncnum?f.push(getNote(localNote.key)):localNote.syncnum>index.data[a].syncnum?f.push(sendNote(localNote)):
localToDOM(localNote.key)):f.push(getNote(index.data[a].key));index.data[a].deleted==0?m++:index.data[a].deleted==1&&g++}if(o==!0)return!1;f.length>0?$.when.apply(null,f).done(function(){c=c+h+1;f=[];sortNotes();refreshCards();l(h)}):(c=c+h+1,f=[],l(h))}index=$.parseJSON(localStorage.index);var a=0,c=0,f=[],m=0,g=0;l(20);$(".note-data").text(m+" notes | ");$(".data_notes").text(m);$(".data_deleted").text(g);$(".status").text("Syncing "+f.length+" notes");$(".status-div").addClass("loading")}).promise()}
function syncIndex(b){return $.Deferred(function(l){$.ajax("/sn.php",{type:"POST",data:b,timeout:5E3,success:function(a){if(a=="401")window.location="/?login=expired";newIndex=$.parseJSON(a);console.log("recieved new index with "+newIndex.count+" new notes");if(localStorage.index){existingIndex=$.parseJSON(localStorage.index);for(i=0;i<=newIndex.data.length-1;i++){for(j=0;j<=existingIndex.data.length-1;j++)if(existingIndex.data[j].key==newIndex.data[i].key){existingIndex.data.splice(j,1);break}existingIndex.data.push(newIndex.data[i])}existingIndex.count=
existingIndex.data.length}else existingIndex=newIndex;localStorage.setItem("mark",newIndex.mark?newIndex.mark:"DONE");console.log(localStorage.mark);localStorage.setItem("index",JSON.stringify(existingIndex));localStorage.setItem("indexDate",newIndex.time);localStorage.mark=="DONE"?(localStorage.removeItem("mark"),console.log("done syncing index"),l.resolve()):(b.mark=localStorage.mark,$.when(syncIndex(b)).done(function(){l.resolve()}))},error:function(){$(".status").text("Working offline. Changes will sync when connected.");
$(".status-div").removeClass("loading")}});console.log("outside index ajax()")}).promise()}function getTagIndex(){return $.Deferred(function(b){postData={action:"tagIndex",email:localStorage.email,token:localStorage.token};console.log("starting tagIndex pull");$.ajax("/sn.php",{type:"POST",data:postData,timeout:5E3,success:function(l){localStorage.tagIndex=l;console.log("stored tagIndex");b.resolve()}})})}
function updateListnote(b){thisnote=$("#list-"+b);thisnote.removeClass("pinned");thisnote.data().systemtags.indexOf("pinned")>-1&&thisnote.addClass("pinned");titlebreak=thisnote.data().content.indexOf("\n");titlebreak<0?(thisnote.children(".title").text(thisnote.data().content.substring(0,100)),thisnote.children(".preview").text("")):(thisnote.children(".title").text(thisnote.data().content.substring(0,titlebreak)),thisnote.children(".preview").text(thisnote.data().content.substr(titlebreak,100)))}
function localToDOM(b){return $.Deferred(function(l){note=$.parseJSON(localStorage.getItem(b));note.deleted!=1&&($("#list-"+note.key).length>0?$("#list-"+note.key).removeData().data(note):$("#listnote-template").clone().attr("id","list-"+note.key).addClass("listnote").appendTo(".list").data(note),updateListnote(note.key),l.resolve())}).promise()}
function allLocalToDOM(){$(".status").text("Loading notes from local storage");$(".status-div").addClass("loading");if(localStorage.index){index=$.parseJSON(localStorage.index);for(i=0;i<=index.data.length-1;i++)localStorage.getItem(index.data[i].key)!=null&&localToDOM(index.data[i].key)}}
function manualSync(b){localStorage.token?$.when(getTagIndex()).done(function(){console.log("done with tag index");$(".status").text("Syncing with Simplenote");$(".status-div").addClass("loading");b=="full"?mark=since="":localStorage.mark?(since="",mark=localStorage.mark):(since=localStorage.indexDate?localStorage.indexDate:"",mark="");email=localStorage.email;token=localStorage.token;$.when(syncIndex({action:"index",email:email,token:token,since:since,mark:mark,length:100})).done(function(){indexFinish=
(new Date).getTime();console.log("indexTime = "+(indexFinish-indexStart));$.when(updateAllNotes()).done(function(){indexDate=stackTime(localStorage.indexDate);$(".status").html('synced <abbr class="timeago" title="'+indexDate+'"></abbr>');bindTimeago();$(".status-div").removeClass("loading");sortNotes();refreshCards()})})}):window.location="/"}var storage="",indexStart="",indexFinish="";
$(function(){localStorage.email?($(".username").text(localStorage.email),localStorage.index&&(allLocalToDOM(),$(".listnote").length>0&&(sortNotes(),refreshCards())),indexStart=(new Date).getTime(),manualSync()):window.location="/"});function nextNote(){nextOne=$(".selected").nextAll(".listnote:not(.hide):first");nextOne.length>0&&($(".selected").removeClass("selected"),nextOne.addClass("selected"),$(".current").removeClass("current").next(".note").addClass("current"),reflowCards(),scrollto())}
function prevNote(){prevOne=$(".selected").prevAll(".listnote:not(.hide):first");prevOne.length>0&&($(".selected").removeClass("selected"),prevOne.addClass("selected"),$(".current").removeClass("current").prev(".note").addClass("current"),reflowCards(),scrollto())}$(".note .textarea textarea").live("focus",function(){$(".current .note-directions").addClass("show");$("div.current").addClass("highlight");$(".window").unmousewheel()});
$(".note .textarea textarea").live("blur",function(){blurkey=$(this).parent().parent().attr("id");if($(this).val()!=$("#list-"+blurkey).data().content)blurnote=$.parseJSON(localStorage.getItem(blurkey)),blurnote.content=$(this).val(),blurnote.modifydate=(new Date).getTime()/1E3,blurnote.syncnum+=1,localStorage.setItem(blurkey,JSON.stringify(blurnote)),localToDOM(blurnote.key),manualSync();$(".current .note-directions").removeClass("show");$(".current").removeClass("highlight");mapMousewheel()});
function togglePin(b){b.data().systemtags.indexOf("pinned")>-1?b.data().systemtags.splice(b.data().systemtags.indexOf("pinned"),1):b.data().systemtags.push("pinned");b.data().syncnum=b.data().syncnum+1;localStorage.setItem(b.data().key,JSON.stringify(b.data()));localToDOM(b.data().key);sortNotes();refreshCards()}
function createNote(){createdate=(new Date).getTime();newid="notestack"+createdate;newdata={key:newid,createdate:createdate/1E3,modifydate:createdate/1E3,tags:[],systemtags:[],content:"new note"};localStorage.setItem(newid,JSON.stringify(newdata));index=$.parseJSON(localStorage.index);index.data.push(newdata);localStorage.index=JSON.stringify(index);localToDOM(newid);sortNotes();$(".selected").removeClass("selected");$("#list-"+newid).addClass("selected");refreshCards();$(".current .textarea textarea").select()}
function scrollto(){$(".selected").position().top<0&&$(".list").scrollTop($(".list").scrollTop()+$(".selected").position().top);$(".selected").position().top+$(".listnote").height()>$(".list").height()&&$(".list").scrollTop($(".list").scrollTop()+$(".selected").position().top-$(".list").height()+$(".listnote").height())}
function toggleVersions(b){$(".versions").hasClass("show")?clearOverlays():(fullscreenMode("off"),$(".versions").addClass("show"),$(".overlay").addClass("show"),$(".versions-right .right-inner").html(""),populateVersions(b))}function updateTags(b){tags=$("#"+b+" .tag-area input").val().split(" ");console.log(tags);note=$.parseJSON(localStorage[b]);if(note.tags!=tags)note.tags=tags,note.syncnum+=1,localStorage[b]=JSON.stringify(note),localToDOM(b),manualSync()}
$(function(){function b(a){var b=$(".fullwindow").attr("class").split(" ");i=0;for(len=b.length;i<len;i++)b[i].substr(0,6)=="theme-"&&(b[i]="");$(".appearance .item.theme").siblings(".theme").addClass("dim");$("#"+a).removeClass("dim");$(".fullwindow").attr("class",b.join(" "));$(".fullwindow").addClass(a);localStorage.theme=a}function l(a){var b=$(".fullwindow").attr("class").split(" ");i=0;for(len=b.length;i<len;i++)b[i].substr(0,5)=="font-"&&(b[i]="");$(".appearance .font").siblings(".font").addClass("dim");
$("#"+a).removeClass("dim");$(".fullwindow").attr("class",b.join(" "));$(".fullwindow").addClass(a);localStorage.font=a}function a(a){var b=$(".fullwindow").attr("class").split(" ");i=0;for(len=b.length;i<len;i++)b[i].substr(0,9)=="fontsize-"&&(b[i]="");$(".appearance .fontsize").siblings(".fontsize").addClass("dim");$("#"+a).removeClass("dim");$(".fullwindow").attr("class",b.join(" "));$(".fullwindow").addClass(a);localStorage.fontsize=a}localStorage.theme?(themename=localStorage.theme,b(themename)):
b("theme-moleskine");$(".appearance .item.theme").click(function(){themename=$(this).attr("id");$(this).removeClass("dim");b(themename)});localStorage.font?(fontname=localStorage.font,l(fontname)):l("font-mono");$(".appearance .font").click(function(){var a=$(this).attr("id");l(a)});localStorage.fontsize?(fontsize=localStorage.fontsize,a(fontsize)):a("fontsize-12");$(".appearance .fontsize").click(function(){var b=$(this).attr("id");a(b)});localStorage.tagPref=="no-tags"&&($(".fullwindow").addClass("no-tags"),
$(".tag-pref").addClass("dim"));$(".appearance .tag-pref").click(function(){$(this).hasClass("dim")?($(this).removeClass("dim"),$(".fullwindow").removeClass("no-tags"),localStorage.removeItem("tagPref")):($(this).addClass("dim"),$(".fullwindow").addClass("no-tags"),localStorage.setItem("tagPref","no-tags"))});$(".addnote").click(function(){createNote()});$(".tags").click(function(){showLabels()});$(".reload").click(function(){manualSync()});$(".close").click(function(){clearOverlays()});$(".delete").live("click",
function(){$(this).parent().children(".message").toggleClass("show").html('Mark this note as deleted?  <a href="#" class="confirmDelete">Delete</a> / <a href="#" class="cancelDelete">Cancel</a>')});$(".confirmDelete").live("click",function(){notekey=$(this).parent().parent().attr("id");deleteNote(notekey);return!1});$(".cancelDelete").live("click",function(){$(".message").removeClass("show");return!1});$(".listnote").live("click",function(){$(".selected").removeClass("selected");$(this).addClass("selected");
$(".current").removeClass("current");$("#"+$(this).attr("id").split("list-").pop()).addClass("current");reflowCards()});$(".note").live("click",function(){$(".current").removeClass("current");$(this).addClass("current");$(".selected").removeClass("selected");$("#list-"+$(this).attr("id")).addClass("selected");reflowCards()});$(".settings_icon").click(function(){$(".settings").toggleClass("show")});$(".username").click(function(){$(".settings").toggleClass("show");$(".settings_pane").removeClass("show");
$(".settings_pane.data").addClass("show")});$(".settings .tabs a").click(function(){$(".settings_pane").removeClass("show");$(".settings_pane."+$(this).text().replace(" ","_")).addClass("show");e.preventDefault();return!1});$(".versions-button").live("mousedown",function(){notekey=$(this).parent().attr("id");toggleVersions(notekey)});$(".version-item").live("mousedown",function(){$(".diff-view").hasClass("depressed")?$(".versions-right .right-inner").html($(this).data().diff):$(".versions-right .right-inner").html('<textarea disabled="disabled">'+
$(this).data().content+"</textarea>");$(".version-select").removeClass("version-select");$(this).addClass("version-select")});$(".versions-toolbar .diff-view,.versions-toolbar .text-view").live("mousedown",function(){$(".versions-toolbar .depressed").removeClass("depressed");$(this).addClass("depressed");$(".version-select").length<1&&$(".version-item:first").addClass(".version-select");$(this).hasClass("diff-view")?$(".versions-right .right-inner").html($(".version-select").data().diff):$(this).hasClass("text-view")&&
$(".versions-right .right-inner").html('<textarea disabled="disabled">'+$(".version-select").data().content+"</textarea>")});$(".overlay").click(function(){clearOverlays()});$(".versions-toolbar .revert-version").live("mousedown",function(){if($(".version-select").length==1)return notekey=$(".version-select").attr("id").split("version").shift(),verContent=$(".version-select").data().content,$(".selected").removeClass("selected"),$("#list-"+notekey).addClass("selected"),$(".current").removeClass("current"),
$("#"+notekey).addClass("current"),reflowCards(),clearOverlays(),$(".note.current .textarea textarea").val(verContent).focus(),!1});$(".cleardata").click(function(){localStorage.clear()});$(document).bind("keydown","esc",function(){clearOverlays()});$(document).bind("keydown","j",function(){nextNote()});$(document).bind("keydown","right",function(){nextNote()});$(document).bind("keydown","down",function(){nextNote()});$(document).bind("keydown","k",function(){prevNote()});$(document).bind("keydown",
"left",function(){prevNote()});$(document).bind("keydown","up",function(){prevNote()});$(document).bind("keydown","return",function(){$(".note.current .textarea textarea").focus();return!1});$(document).bind("keydown","tab",function(){$(".note.current .textarea textarea").focus();return!1});$(document).bind("keydown","shift+/",function(){$(".settings").toggleClass("show")});$(document).bind("keydown","/",function(){$(".search input").select();return!1});$(document).bind("keydown","c",function(){createNote();
return!1});$(document).bind("keydown","s",function(){manualSync();return!1});$(document).bind("keydown","p",function(){togglePin($(".selected"))});$(document).bind("keydown","f",function(){fullscreenMode()});$(document).bind("keydown","l",function(){showLabels();return!1});$(document).bind("keydown","t",function(){showLabels();return!1});$(document).bind("keydown","v",function(){toggleVersions($(".current").attr("id"));return!1});$(".search input").bind("keydown","return",function(){$(this).blur();
return!1});$(".search input").bind("keydown","esc",function(){$(this).val("");refreshSearch();$(this).blur();return!1});$(".labels input").bind("keydown","esc",function(){$(this).val("");$(this).blur();clearOverlays();return!1});$(".labels input").bind("keydown","down",function(){nextLabel();return!1});$(".labels input").bind("keydown","up",function(){prevLabel();return!1});$(".labels input").bind("keydown","return",function(){filterByLabel($(".label-select .name").text())});refreshNoteBinds(".note .textarea textarea")});
function refreshNoteBinds(b){$(b).bind("keydown","esc",function(){$(".note-directions").removeClass("show");$(this).blur()});$(b).tabby();$(".maximize").click(function(){fullscreenMode()});$(".tagsinput div input").blur(function(){updateTags($(".current").attr("id"))})}
function deleteNote(b){note=$("#list-"+b).data();note.deleted=1;note.modifydate=(new Date).getTime()/1E3;note.syncnum+=1;localStorage.setItem(note.key,JSON.stringify(note));$("#list-"+b).remove();$("#"+b).remove();$(".listnote:first").addClass(".selected");refreshCards()}function clearOverlays(){$(".show:not(.settings_pane)").removeClass("show");fullscreenMode("off")}
function fullscreenMode(b){b=="off"?($(".fullwindow").removeClass("fullscreen-mode"),$(".overlay").removeClass("show")):b=="on"?($(".fullwindow").addClass("fullscreen-mode"),$(".overlay").addClass("show")):($(".fullwindow").toggleClass("fullscreen-mode"),$(".overlay").toggleClass("show"))}
function showLabels(){$(".labels").hasClass("show")?clearOverlays():(fullscreenMode("off"),populateLabels(),$(".labels").addClass("show"),$(".overlay").addClass("show"),$(".labels input").val("").select());return!1}
function populateLabels(){$(".labels .item").remove();for(var b=$.parseJSON(localStorage.index),l=0,a=0,c=0,f=0,m="",g={},l=0,c=b.data.length;l<c;l++){a=0;for(f=b.data[l].tags.length;a<f;a++)m=b.data[l].tags[a],g[m]?g[m]++:g[m]=1}for(var h in g)g.hasOwnProperty(h)&&($("#label-template").clone().attr("id",h).addClass("item").appendTo(".labels .items"),$("#"+h).children(".name").text(h),$("#"+h).children(".notecount").text(g[h]+" notes"));$(".labels .item").sortElements(function(a,b){return parseFloat($(a).children(".notecount").text())<
parseFloat($(b).children(".notecount").text())?1:-1})}$(function(){$(".labels input").keyup(function(b){b=b.which;b!=38&&b!=40&&b!=13&&labelSearch()})});function labelSearch(){query=$(".labels input").val().toLowerCase();$(".labels .item").each(function(){$(this).children(".name").text().toLowerCase().indexOf(query)>-1?$(this).removeClass("hide"):$(this).addClass("hide")});$(".label-select").removeClass("label-select");$(".labels .item:not(.hide):first").addClass("label-select")}
function prevLabel(){prevOne=$(".label-select").prevAll(".item:not(.hide):first");prevOne.length>0&&($(".label-select").removeClass("label-select"),prevOne.addClass("label-select"))}function nextLabel(){nextOne=$(".label-select").nextAll(".item:not(.hide):first");nextOne.length>0&&($(".label-select").removeClass("label-select"),nextOne.addClass("label-select"))}$(function(){mapMousewheel()});function mapMousewheel(){return!1}$(function(){$(".search input").keyup(function(){$.debounce(250,refreshSearch())})});
function refreshSearch(){query=$(".search input").val().toLowerCase();$(".listnote").each(function(){$(this).data().content.toLowerCase().indexOf(query)>-1?$(this).removeClass("hide"):$(this).addClass("hide")});$(".selected").removeClass("selected");$(".listnote:not(.hide):first").addClass("selected");refreshCards()}$(function(){bindTimeago()});function bindTimeago(){$(".timeago").timeago()}
function makeLinks(){currentTextarea=$(".current .textarea textarea").val();$(".current .textarea textarea").val(linkify(currentTextarea))}
function linkify(b){replacedText=b.replace(/(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gim,'<a href="$1" target="_blank">$1</a>');replacedText=replacedText.replace(/(^|[^\/])(www\.[\S]+(\b|$))/gim,'$1<a href="http://$2" target="_blank">$2</a>');return replacedText=replacedText.replace(/(\w+@[a-zA-Z_]+?\.[a-zA-Z]{2,6})/gim,'<a href="mailto:$1">$1</a>')}
function stackTime(b){offset_dt=(new Date).getTimezoneOffset()*60;epoch_num=parseFloat(b);time_num=(epoch_num+offset_dt)*1E3;return time_dt=(new Date(epoch_num*1E3)).toISOString()}function padzero(b){return b<10?"0"+b:b}function pad2zeros(b){b<100&&(b="0"+b);b<10&&(b="0"+b);return b}
function toISOString(b){return b.getUTCFullYear()+"-"+padzero(b.getUTCMonth()+1)+"-"+padzero(b.getUTCDate())+"T"+padzero(b.getUTCHours())+":"+padzero(b.getUTCMinutes())+":"+padzero(b.getUTCSeconds())+"."+pad2zeros(b.getUTCMilliseconds())+"Z"}function fnToISO(){alert(toISOString(new Date))};